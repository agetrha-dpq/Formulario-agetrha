<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard AGETRHA - Gest√£o de Candidaturas</title>
    <style>
        /* TODO O CSS PERMANECE IGUAL */
        * {
            box-sizing: border-box;
            font-family: 'Segoe UI', Arial, sans-serif;
        }
        
        body {
            margin: 0;
            padding: 0;
            background: #f5f7fa;
            color: #333;
        }
        
        .admin-login {
            max-width: 400px;
            margin: 100px auto;
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            text-align: center;
        }
        
        .admin-login h2 {
            color: #5a9cf8;
            margin-bottom: 20px;
        }
        
        .admin-login input {
            width: 100%;
            padding: 12px;
            margin: 15px 0;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            text-align: center;
        }
        
        .admin-login button {
            background-color: #5a9cf8;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: background-color 0.3s;
            width: 100%;
        }
        
        .admin-login button:hover {
            background-color: #4a8be5;
        }
        
        .admin-error {
            color: #e74c3c;
            margin: 10px 0;
            display: none;
        }
        
        /* TODO O RESTO DO CSS PERMANECE IGUAL */
        .dashboard {
            display: none;
        }
        
        .dashboard-header {
            background: white;
            padding: 20px 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .dashboard-header h1 {
            color: #5a9cf8;
            margin: 0;
            font-size: 24px;
        }
        
        .logout-btn {
            background: #dc3545;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
        }
        
        .logout-btn:hover {
            background: #e15361;
        }
        
        .dashboard-content {
            padding: 30px;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .metric-card {
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            text-align: center;
            border-left: 4px solid #5a9cf8;
        }
        
        .metric-card h3 {
            margin: 0 0 10px 0;
            color: #666;
            font-size: 14px;
            text-transform: uppercase;
        }
        
        .metric-value {
            font-size: 2.5em;
            font-weight: bold;
            color: #5a9cf8;
            margin: 0;
        }
        
        .candidates-section {
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .section-title {
            color: #5a9cf8;
            margin-bottom: 20px;
            font-size: 20px;
        }
        
        .filters {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .filters input, .filters select {
            padding: 10px 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
            min-width: 200px;
        }
        
        .filters input:focus, .filters select:focus {
            border-color: #5a9cf8;
            outline: none;
        }
        
        .candidates-list {
            max-height: 600px;
            overflow-y: auto;
        }
        
        .candidate-item {
            border: 1px solid #eee;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 15px;
            background: #f9fafc;
            transition: transform 0.2s;
        }
        
        .candidate-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .candidate-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }
        
        .candidate-name {
            font-weight: bold;
            font-size: 18px;
            color: #333;
            margin: 0;
        }
        
        .candidate-code {
            color: #5a9cf8;
            font-weight: bold;
            font-size: 14px;
        }
        
        .candidate-details {
            color: #666;
            font-size: 14px;
            margin-bottom: 15px;
            line-height: 1.5;
        }
        
        .candidate-actions {
            display: flex;
            gap: 10px;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .status-select {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background: white;
            font-size: 14px;
        }
        
        .export-btn {
            background: #28a745;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 13px;
            transition: background 0.3s;
        }
        
        .export-btn:hover {
            background: #34ce57;
        }
        
        .status-badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            color: white;
            display: inline-block;
        }
        
        .status-recebida { background: #3498db; }
        .status-contactada { background: #f39c12; }
        .status-aprovada { background: #27ae60; }
        .status-arquivada { background: #95a5a6; }
        
        .loading {
            display: none;
            text-align: center;
            padding: 40px;
            color: #666;
        }
        
        .loading-spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #5a9cf8;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 2s linear infinite;
            margin: 0 auto 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        @media (max-width: 768px) {
            .dashboard-content {
                padding: 15px;
            }
            
            .filters {
                flex-direction: column;
            }
            
            .filters input, .filters select {
                min-width: 100%;
            }
            
            .candidate-header {
                flex-direction: column;
                gap: 10px;
            }
            
            .candidate-actions {
                flex-direction: column;
                align-items: flex-start;
            }
        }
    </style>
</head>
<body>
    <!-- Tela de Login Administrativo -->
    <div id="adminLogin" class="admin-login">
        <h2>üîê Acesso Administrativo AGETRHA</h2>
        <p>Digite a senha de administrador:</p>
        <input type="password" id="adminPassword" placeholder="Senha administrativa">
        <div class="admin-error" id="adminError">Senha incorreta. Tente novamente.</div>
        <button onclick="validarAdmin()">Acessar Dashboard</button>
    </div>

    <!-- Dashboard Principal -->
    <div id="dashboard" class="dashboard">
        <header class="dashboard-header">
            <h1>üìä Dashboard AGETRHA - Gest√£o de Candidaturas</h1>
            <button class="logout-btn" onclick="sairDashboard()">üö™ Sair do Sistema</button>
        </header>

        <div class="dashboard-content">
            <!-- M√©tricas -->
            <div class="metrics-grid">
                <div class="metric-card">
                    <h3>Total de Candidaturas</h3>
                    <div id="totalCandidaturas" class="metric-value">0</div>
                </div>
                <div class="metric-card">
                    <h3>Novas Este M√™s</h3>
                    <div id="novasEsteMes" class="metric-value">0</div>
                </div>
                <div class="metric-card">
                    <h3>Candidaturas Pendentes</h3>
                    <div id="candidaturasPendentes" class="metric-value">0</div>
                </div>
                <div class="metric-card">
                    <h3>Taxa de Contacto</h3>
                    <div id="taxaContacto" class="metric-value">0%</div>
                </div>
            </div>

            <!-- Lista de Candidaturas -->
            <div class="candidates-section">
                <h2 class="section-title">üë• Todas as Candidaturas</h2>
                
                <div class="filters">
                    <input type="text" id="searchInput" placeholder="üîç Pesquisar por nome ou c√≥digo...">
                    <select id="statusFilter">
                        <option value="">Todos os status</option>
                        <option value="Recebida">Recebida</option>
                        <option value="Contactada">Contactada</option>
                        <option value="Aprovada">Aprovada</option>
                        <option value="Arquivada">Arquivada</option>
                    </select>
                    <select id="categoriaFilter">
                        <option value="">Todas as categorias</option>
                        <option value="S√≥cio Efectivo">S√≥cio Efectivo</option>
                        <option value="S√≥cio Colectivo">S√≥cio Colectivo</option>
                        <option value="S√≥cio Correspondente">S√≥cio Correspondente</option>
                        <option value="S√≥cio Aderente">S√≥cio Aderente</option>
                        <option value="S√≥cio Honor√°rio">S√≥cio Honor√°rio</option>
                    </select>
                </div>

                <div class="loading" id="loadingCandidates">
                    <div class="loading-spinner"></div>
                    <p>Carregando candidaturas...</p>
                </div>

                <div id="candidaturasList" class="candidates-list">
                    <!-- Lista de candidaturas ser√° preenchida aqui -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // ‚≠ê‚≠ê CONFIGURA√á√ÉO PRINCIPAL - URL CORRETO ‚≠ê‚≠ê
        const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbzYSkz5DS4yr7Pd2YgIUvjXY7kj_vBXa5fggmor0RMIALpfE8nfL7n6irWjut4hW3QUMQ/exec';
        
        // Elementos DOM
        const adminLogin = document.getElementById('adminLogin');
        const dashboard = document.getElementById('dashboard');
        const adminPasswordInput = document.getElementById('adminPassword');
        const adminError = document.getElementById('adminError');
        
        const totalCandidaturasElement = document.getElementById('totalCandidaturas');
        const novasEsteMesElement = document.getElementById('novasEsteMes');
        const candidaturasPendentesElement = document.getElementById('candidaturasPendentes');
        const taxaContactoElement = document.getElementById('taxaContacto');
        const candidaturasListElement = document.getElementById('candidaturasList');
        const loadingCandidates = document.getElementById('loadingCandidates');
        
        const searchInput = document.getElementById('searchInput');
        const statusFilter = document.getElementById('statusFilter');
        const categoriaFilter = document.getElementById('categoriaFilter');
        
        // Vari√°veis globais
        let todasCandidaturas = [];
        
        // üîê VALIDA√á√ÉO DE ADMIN - AGORA USA VALIDA√á√ÉO DO SERVIDOR
        async function validarAdmin() {
            const password = adminPasswordInput.value;
            
            if (!password) {
                adminError.textContent = 'Por favor, digite a senha';
                adminError.style.display = 'block';
                return;
            }
            
            try {
                const response = await fetch(`${GOOGLE_SCRIPT_URL}?action=validateAdmin&password=${encodeURIComponent(password)}`);
                const result = await response.json();
                
                if (result.valid) {
                    adminLogin.style.display = 'none';
                    dashboard.style.display = 'block';
                    carregarDashboard();
                } else {
                    adminError.textContent = 'Senha incorreta. Tente novamente.';
                    adminError.style.display = 'block';
                    adminPasswordInput.value = '';
                    adminPasswordInput.focus();
                }
            } catch (error) {
                adminError.textContent = 'Erro de conex√£o. Tente novamente.';
                adminError.style.display = 'block';
                console.error('Erro na valida√ß√£o:', error);
            }
        }
        
        function sairDashboard() {
            dashboard.style.display = 'none';
            adminLogin.style.display = 'block';
            adminPasswordInput.value = '';
            adminError.style.display = 'none';
            todasCandidaturas = [];
        }
        
        // üìä CARREGAR DASHBOARD
        async function carregarDashboard() {
            loadingCandidates.style.display = 'block';
            candidaturasListElement.innerHTML = '';
            
            try {
                const [candidaturas, estatisticas] = await Promise.all([
                    obterCandidaturas(),
                    obterEstatisticas()
                ]);
                
                todasCandidaturas = candidaturas;
                atualizarMetricas(estatisticas);
                atualizarListaCandidaturas(candidaturas);
                
            } catch (error) {
                console.error('Erro ao carregar dashboard:', error);
                alert('Erro ao carregar dados da dashboard.');
            } finally {
                loadingCandidates.style.display = 'none';
            }
        }
        
        // üìà OBTER DADOS
        async function obterCandidaturas() {
            try {
                const response = await fetch(`${GOOGLE_SCRIPT_URL}?action=getCandidates`);
                const result = await response.json();
                
                if (result.success) {
                    return result.candidates;
                } else {
                    throw new Error(result.message);
                }
            } catch (error) {
                console.error('Erro ao obter candidaturas:', error);
                return [];
            }
        }
        
        async function obterEstatisticas() {
            try {
                const response = await fetch(`${GOOGLE_SCRIPT_URL}?action=getDashboardStats`);
                const result = await response.json();
                
                if (result.success) {
                    return result.stats;
                } else {
                    throw new Error(result.message);
                }
            } catch (error) {
                console.error('Erro ao obter estat√≠sticas:', error);
                return {
                    total: 0,
                    esteMes: 0,
                    porCategoria: {},
                    porStatus: {}
                };
            }
        }
        
        // üéØ ATUALIZAR M√âTRICAS
        function atualizarMetricas(estatisticas) {
            totalCandidaturasElement.textContent = estatisticas.total;
            novasEsteMesElement.textContent = estatisticas.esteMes;
            
            const pendentes = estatisticas.porStatus['Recebida'] || 0;
            candidaturasPendentesElement.textContent = pendentes;
            
            // Calcular taxa de contacto
            const totalContactadas = estatisticas.porStatus['Contactada'] || 0;
            const totalAprovadas = estatisticas.porStatus['Aprovada'] || 0;
            const totalContactos = totalContactadas + totalAprovadas;
            const taxa = estatisticas.total > 0 ? Math.round((totalContactos / estatisticas.total) * 100) : 0;
            taxaContactoElement.textContent = taxa + '%';
        }
        
        // üìã ATUALIZAR LISTA DE CANDIDATURAS
        function atualizarListaCandidaturas(candidaturas) {
            candidaturasListElement.innerHTML = '';
            
            if (candidaturas.length === 0) {
                candidaturasListElement.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: #666;">
                        <p style="font-size: 18px; margin-bottom: 10px;">üì≠</p>
                        <p>Nenhuma candidatura encontrada.</p>
                    </div>
                `;
                return;
            }
            
            // Ordenar por data (mais recentes primeiro)
            candidaturas.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
            
            candidaturas.forEach(candidatura => {
                const item = document.createElement('div');
                item.className = 'candidate-item';
                
                item.innerHTML = `
                    <div class="candidate-header">
                        <div>
                            <div class="candidate-name">${candidatura.nome}</div>
                            <div class="candidate-code">${candidatura.codigo_inscricao}</div>
                        </div>
                        <div class="status-badge status-${candidatura.status.toLowerCase()}">
                            ${candidatura.status}
                        </div>
                    </div>
                    <div class="candidate-details">
                        <div><strong>üìß Email:</strong> ${candidatura.email || 'N√£o informado'}</div>
                        <div><strong>üìû Telefone:</strong> ${candidatura.telefone || 'N√£o informado'}</div>
                        <div><strong>üéØ Categoria:</strong> ${candidatura.categoria}</div>
                        <div><strong>üìÖ Data de Cadastro:</strong> ${formatarData(candidatura.data_cadastro)}</div>
                        ${candidatura.empresa ? `<div><strong>üè¢ Empresa:</strong> ${candidatura.empresa}</div>` : ''}
                        ${candidatura.cargo ? `<div><strong>üíº Cargo:</strong> ${candidatura.cargo}</div>` : ''}
                    </div>
                    <div class="candidate-actions">
                        <select class="status-select" onchange="atualizarStatus('${candidatura.codigo_inscricao}', this.value)">
                            <option value="Recebida" ${candidatura.status === 'Recebida' ? 'selected' : ''}>üì• Recebida</option>
                            <option value="Contactada" ${candidatura.status === 'Contactada' ? 'selected' : ''}>üìû Contactada</option>
                            <option value="Aprovada" ${candidatura.status === 'Aprovada' ? 'selected' : ''}>‚úÖ Aprovada</option>
                            <option value="Arquivada" ${candidatura.status === 'Arquivada' ? 'selected' : ''}>üìÅ Arquivada</option>
                        </select>
                        <button class="export-btn" onclick="exportarCandidatura('${candidatura.codigo_inscricao}')">
                            üìÑ Exportar PDF
                        </button>
                    </div>
                `;
                
                candidaturasListElement.appendChild(item);
            });
        }
        
        // üîÑ ATUALIZAR STATUS
        async function atualizarStatus(codigoInscricao, novoStatus) {
            try {
                const response = await fetch(GOOGLE_SCRIPT_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded',
                    },
                    body: `action=updateCandidateStatus&codigoInscricao=${encodeURIComponent(codigoInscricao)}&novoStatus=${encodeURIComponent(novoStatus)}`
                });
                
                const result = await response.json();
                
                if (result.success) {
                    // Recarregar a dashboard para refletir as mudan√ßas
                    carregarDashboard();
                } else {
                    alert('Erro ao atualizar status: ' + result.message);
                }
            } catch (error) {
                console.error('Erro ao atualizar status:', error);
                alert('Erro ao atualizar status.');
            }
        }
        
        // üìÑ EXPORTAR CANDIDATURA
        function exportarCandidatura(codigoInscricao) {
            // Encontrar a candidatura espec√≠fica
            const candidatura = todasCandidaturas.find(c => c.codigo_inscricao === codigoInscricao);
            
            if (!candidatura) {
                alert('Candidatura n√£o encontrada.');
                return;
            }
            
            // Criar um conte√∫do para impress√£o
            const conteudoImpressao = `
                <!DOCTYPE html>
                <html>
                <head>
                    <title>Ficha de Candidatura - ${candidatura.codigo_inscricao}</title>
                    <style>
                        body { 
                            font-family: Arial, sans-serif; 
                            padding: 20px; 
                            line-height: 1.6;
                            color: #333;
                        }
                        .header { 
                            text-align: center; 
                            margin-bottom: 30px;
                            border-bottom: 3px solid #5a9cf8;
                            padding-bottom: 20px;
                        }
                        .header h1 { 
                            color: #5a9cf8; 
                            margin: 0;
                        }
                        .container {
                            display: flex;
                            gap: 30px;
                            margin-bottom: 20px;
                        }
                        .photo-section {
                            flex: 0 0 150px;
                            text-align: center;
                        }
                        .candidate-photo {
                            width: 120px;
                            height: 150px;
                            border: 2px solid #ddd;
                            border-radius: 5px;
                            object-fit: cover;
                            margin-bottom: 10px;
                        }
                        .details-section {
                            flex: 1;
                        }
                        .section { 
                            margin-bottom: 25px; 
                            padding: 20px;
                            background: #f9fafc;
                            border-radius: 8px;
                            border-left: 4px solid #5a9cf8;
                        }
                        .section-title { 
                            font-weight: bold; 
                            color: #5a9cf8;
                            margin-bottom: 15px;
                            font-size: 18px;
                        }
                        .field { 
                            margin-bottom: 8px; 
                            display: flex;
                        }
                        .label { 
                            font-weight: bold; 
                            width: 200px;
                            flex-shrink: 0;
                        }
                        .value {
                            flex: 1;
                        }
                        .photo-placeholder {
                            width: 120px;
                            height: 150px;
                            border: 2px dashed #ccc;
                            border-radius: 5px;
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            color: #666;
                            font-size: 12px;
                            text-align: center;
                            background: #f9f9f9;
                        }
                        @media print {
                            body { padding: 10px; }
                            .section { break-inside: avoid; }
                            .container { break-inside: avoid; }
                        }
                    </style>
                </head>
                <body>
                    <div class="header">
                        <h1>FORMUL√ÅRIO DE CANDIDATURA ‚Äì AGETRHA</h1>
                        <p>Associa√ß√£o dos Gestores e T√©cnicos de Recursos Humanos de Angola</p>
                        <p><strong>C√≥digo de Inscri√ß√£o:</strong> ${candidatura.codigo_inscricao}</p>
                    </div>
                    
                    <div class="container">
                        <div class="photo-section">
                            <div class="photo-placeholder">Foto<br>3.5x4.5 cm<br>(Upload no formul√°rio)</div>
                            <div style="font-size: 11px; color: #666;">Foto 3.5x4.5 cm</div>
                        </div>
                        <div class="details-section">
                            <div class="section">
                                <div class="section-title">üîπ DADOS PESSOAIS</div>
                                <div class="field"><span class="label">Nome Completo:</span><span class="value">${candidatura.nome}</span></div>
                                <div class="field"><span class="label">Data de Nascimento:</span><span class="value">${formatarData(candidatura.nascimento)}</span></div>
                                <div class="field"><span class="label">BI/Passaporte:</span><span class="value">${candidatura.bi}</span></div>
                                <div class="field"><span class="label">NIF:</span><span class="value">${candidatura.nif || 'N√£o informado'}</span></div>
                                <div class="field"><span class="label">Nacionalidade:</span><span class="value">${candidatura.nacionalidade}</span></div>
                                <div class="field"><span class="label">Endere√ßo:</span><span class="value">${candidatura.endereco || 'N√£o informado'}</span></div>
                                <div class="field"><span class="label">Telefone/Whatsapp:</span><span class="value">${candidatura.telefone}</span></div>
                                <div class="field"><span class="label">E-mail:</span><span class="value">${candidatura.email || 'N√£o informado'}</span></div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="section">
                        <div class="section-title">üîπ DADOS PROFISSIONAIS</div>
                        <div class="field"><span class="label">Institui√ß√£o/Empresa:</span><span class="value">${candidatura.empresa || 'N√£o informado'}</span></div>
                        <div class="field"><span class="label">Cargo/Fun√ß√£o:</span><span class="value">${candidatura.cargo || 'N√£o informado'}</span></div>
                        <div class="field"><span class="label">√Årea de Atua√ß√£o:</span><span class="value">${candidatura.area || 'N√£o informado'}</span></div>
                        <div class="field"><span class="label">Endere√ßo Profissional:</span><span class="value">${candidatura.endereco_profissional || 'N√£o informado'}</span></div>
                        <div class="field"><span class="label">Contato Profissional:</span><span class="value">${candidatura.contato_profissional || 'N√£o informado'}</span></div>
                    </div>
                    
                    <div class="section">
                        <div class="section-title">üîπ QUALIFICA√á√ÉO ACAD√âMICA</div>
                        <div class="field"><span class="label">Qualifica√ß√µes:</span><span class="value">${candidatura.qualificacoes || 'N√£o informado'}</span></div>
                        <div class="field"><span class="label">√Årea de Forma√ß√£o:</span><span class="value">${candidatura.area_formacao || 'N√£o informado'}</span></div>
                        <div class="field"><span class="label">Institui√ß√£o de Ensino:</span><span class="value">${candidatura.instituicao_ensino || 'N√£o informado'}</span></div>
                    </div>
                    
                    <div class="section">
                        <div class="section-title">üîπ OUTRAS INFORMA√á√ïES</div>
                        <div class="field"><span class="label">Categoria de Membro:</span><span class="value">${candidatura.categoria}</span></div>
                        <div class="field"><span class="label">Documentos Anexos:</span><span class="value">${candidatura.documentos || 'N√£o informado'}</span></div>
                        <div class="field"><span class="label">Data de Cadastro:</span><span class="value">${formatarData(candidatura.data_cadastro)}</span></div>
                        <div class="field"><span class="label">Status:</span><span class="value">${candidatura.status}</span></div>
                    </div>
                </body>
                </html>
            `;
            
            const janelaImpressao = window.open('', '_blank');
            janelaImpressao.document.write(conteudoImpressao);
            janelaImpressao.document.close();
            
            // Aguardar um pouco para a imagem carregar antes de imprimir
            setTimeout(() => {
                janelaImpressao.print();
            }, 500);
        }
        
        // üóìÔ∏è FORMATAR DATA
        function formatarData(dataString) {
            if (!dataString) return 'N/A';
            try {
                const data = new Date(dataString);
                return data.toLocaleDateString('pt-PT');
            } catch (e) {
                return dataString;
            }
        }
        
        // üîç FILTROS
        searchInput.addEventListener('input', aplicarFiltros);
        statusFilter.addEventListener('change', aplicarFiltros);
        categoriaFilter.addEventListener('change', aplicarFiltros);
        
        function aplicarFiltros() {
            const termoPesquisa = searchInput.value.toLowerCase();
            const statusSelecionado = statusFilter.value;
            const categoriaSelecionada = categoriaFilter.value;
            
            const candidaturasFiltradas = todasCandidaturas.filter(candidatura => {
                const correspondePesquisa = 
                    candidatura.nome.toLowerCase().includes(termoPesquisa) ||
                    candidatura.codigo_inscricao.toLowerCase().includes(termoPesquisa) ||
                    (candidatura.email && candidatura.email.toLowerCase().includes(termoPesquisa)) ||
                    (candidatura.empresa && candidatura.empresa.toLowerCase().includes(termoPesquisa));
                
                const correspondeStatus = !statusSelecionado || candidatura.status === statusSelecionado;
                const correspondeCategoria = !categoriaSelecionada || candidatura.categoria === categoriaSelecionada;
                
                return correspondePesquisa && correspondeStatus && correspondeCategoria;
            });
            
            atualizarListaCandidaturas(candidaturasFiltradas);
        }
        
        // ‚Ü©Ô∏è ENTER NO CAMPO DE SENHA
        adminPasswordInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                validarAdmin();
            }
        });
        
        // üéØ INICIALIZA√á√ÉO
        console.log('üöÄ Dashboard AGETRHA carregada e pronta!');
    </script>
</body>
</html>
